---
date: 2023-04-27T14:30:00+01:00
title: "Introducing Leaf Computing"
excerpt: "The leaf software architecture keeps users in control with local execution and data storage, autonomous functionality, and federated interoperability."
excerptImage: "leaf-computing.jpg"
layout: presentation.hbs
tags:
  - "posts"
  - "conferenceTalk"
  - "API"
---

<div class="container mx-auto">
	<p class="italic">This is an adaptation of my presentation at API Conference in London, UK on April 27, 2023 and Apidays Helsinki on June 4, 2023 (<a href="https://www.youtube.com/watch?v=aVUYWxpCTRc&list=PLmEaqnTJ40OpxOICagfFUzt8FnXh78F3m&index=10">video recording</a>). More information can be found at <a href="https://www.leafcomputing.net">LeafComputing.net</a>.</p>
</div>

<div id="introduction" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#introduction"><img src="/posts/leaf-computing/slide-1.webp" loading="lazy" alt="Introducing Leaf Computing. Jeremiah Lee. 2023-04-27"></a>
	</div>
	<div class="md:w-1/2">
		<p>Today I’m going to share some ideas publicly for the first time that I have been thinking about for a decade from my work on Fitbit smart watches, Spotify Connect devices, and e-bikes.</p>
		<p>I call it leaf computing. It’s what I think comes next, after cloud computing. It’s both a complement and a replacement. It’s what I think is necessary—both technically and politically—to rebalance the power of technology back to empowering users first. To explain this, I will share a few stories.</p>
	</div>
</div>

<div id="banff" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#banff"><img src="/posts/leaf-computing/slide-2.webp" loading="lazy" alt="Tall snow-covered mountains in front of water"><img src="/posts/leaf-computing/slide-3.webp" loading="lazy" alt="A snow covered glacier"></a>
	</div>
	<div class="md:w-1/2">
		<p>In 2015, I spent a week hiking in Banff, Canada. It’s one of the most stunning national parks I have ever been to. Banff is filled with tall mountains, deep valleys, and wide glaciers.</p>
	</div>
</div>

<div id="gear" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#gear"><img src="/posts/leaf-computing/slide-4.webp" loading="lazy" alt="President Obama wearing a Fitbit Surge. Fitbit app showing a hike workout summary on a Windows Phone"></a>
		<p class="text-sm"><cite><a href="https://www.geekwire.com/2016/smartwatch-president-barack-obama-wears/">This is the smartwatch that President Barack Obama wears</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>Along with my usual hiking gear, I had a Fitbit fitness watch and my smartphone. My Fitbit smart watch recorded my GPS location, steps, heart rate, elevation change, and all that great data from my wrist. At the end of the day, I wanted to view my data on my phone. Only here was a little problem.</p>
	</div>
</div>

<div id="timeout" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#timeout"><img src="/posts/leaf-computing/slide-5.webp" loading="lazy" alt="2 screenshots of the Fitbit app showing a hike with GPS coordinates and graphs for pace, elevation, heart rate, and calories burned, and a workout daily impact summary"></a>
	</div>
	<div class="md:w-1/2">
		<p>Cell coverage was limited to the main roads and even then, it was quite slow 3G. Again, it was 2015. It was too slow to upload all of that data from my smartwatch to Fitbit’s servers. While the upload made steady, incremental progress, Fitbit’s servers would cut off the connection after 2 minutes. I tried and retried, but it kept failing after 2 minutes.</p>
	</div>
</div>

<div id="smartish-watch" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#smartish-watch"><img src="/posts/leaf-computing/slide-6.webp" loading="lazy" alt="Story time: smart-ish watch"></a>
	</div>
	<div class="md:w-1/2">
		<p>Now, I was working as a software engineer on Fitbit’s API at the time. I had a hunch about the reason: our reverse-proxy server timeout was set to 120 seconds. We hadn’t anticipated the possibility of a half MB of data taking longer than 2 minutes to upload. Keep in mind, that’s slower than a 56K modem.</p>
		<p>My smart watch and my smart phone were not so smart when in the wilderness. I had some of the capabilities, like collecting the data and seeing some of the data on the watch, but I couldn’t get the full experience on my phone because of my intermittent Internet connectivity.</p>
	</div>
</div>

<div id="garmin" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#garmin"><img src="/posts/leaf-computing/slide-8.webp" loading="lazy" alt="Screenshot of ZD Net article. Garmin services and production go down after ransomware attack. Smartwatch and wearable maker Garmin planning multi-day maintenance window to deal with ransomware incident."></a>
	</div>
	<div class="md:w-1/2">
		<p>This connectivity problem was on the client side, but problems can exist on the server side as well. That happened to Fitbit’s competitor, Garmin, in July 2020.</p>
		<p>A hacker gained access to Garmin’s internal computer systems. (<a href="https://www.zdnet.com/article/garmin-services-and-production-go-down-after-ransomware-attack/" title="Garmin services and production go down after ransomware attack">source</a>) It held the company hostage for 5 days demanding $10M. It’s unknown if Garmin paid the ransom, but for 2 days it went completely offline. Most Garmin smart watches just didn’t sync for 2 days.</p>
	</div>
</div>

<div id="aws" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#aws"><img src="/posts/leaf-computing/slide-9.webp" loading="lazy" alt="Graph showing Amazon with ~33% marketshare. Trailed by Microsoft, Google, Alibaba, and IBM."></a>
	</div>
	<div class="md:w-1/2">
		<p>But server outages are not caused exclusively by hackers.</p>
		<p>AWS is the most popular cloud infrastructure provider in the world with <a href="https://techcrunch.com/2023/02/06/even-as-cloud-infrastructure-market-growth-slows-microsoft-continues-to-gain-on-amazon/" title="Even as cloud infrastructure market growth slows, Microsoft continues to gain on Amazon">33% marketshare</a>. That means a significant portion of what you do online everyday touches AWS’s data centers. What happens when it goes down? We don’t have to imagine, we get a reminder every few years of what happens.</p>
	</div>
</div>

<div id="aws-outage" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#aws-outage"><img src="/posts/leaf-computing/slide-10.webp" loading="lazy" alt="Screenshot of ZD Net article. AWS suffers third outage of the month. Although it may have been a short duration event, AWS' latest outage served as another unwelcome reminder of just how much of the internet AWS can take down with it when it suffers even a localized fault."></a>
	</div>
	<div class="md:w-1/2">
		<p>The US-east-1 region is AWS’s most popular datacenter. It’s the default region for many of AWS’s services and typically the first region to get new features.</p>
		<p>In December 2021, AWS US-east-1 region went down 3 separate times, the worst incident for about 7 hours. (<a href="https://www.zdnet.com/article/aws-suffers-third-outage-of-the-month/" title="AWS suffers third outage of the month ">source</a>) Popular websites like IMDb, Riot Games, apps like Slack and Asana were just down. But websites and apps that depend on the Web going down is kinda expected in such an outage.</p>
	</div>
</div>

<div id="internet-of-shit" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#internet-of-shit"><img src="/posts/leaf-computing/slide-11.webp" loading="lazy" alt="3 tweets. I can't vacuum because US-East-1 is down. My fucking doorbell doesn't work because AWS us-east-1 is having issues. Last US-East-1 outage I couldn't actually turn on a whole series of lights bc they power was controlled inside the bulb by the smart WiFi integration."></a>
	</div>
	<div class="md:w-1/2">
		<p>More interesting to me however is that floors went unvacuumed during this time. Roomba robotic vacuums stopped working. Doors went unanswered because Amazon Ring doorbells stopped working. People were left in the dark because some smart light brands couldn’t turn on/off.</p>
		<p>At least they eventually started working again.</p>
		<p>I’ve mentioned hackers taking servers offline and cloud providers accidentally taking themselves offline, but another way servers go offline is when you stop paying for them because your company goes out of business.</p>
	</div>
</div>

<div id="insteoff" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#insteoff"><img src="/posts/leaf-computing/slide-12.webp" loading="lazy" alt="Screenshot of Ars Technica article. Leaving users in the dark. Shameful: Insteon looks dead-just like its users smart homes. The app and servers are dead. The CEO scrubbed his LinkedIn page. No one is responding."></a>
		<p class="text-sm"><cite><a href="https://arstechnica.com/gadgets/2022/04/shameful-insteon-looks-dead-just-like-its-users-smart-homes/">Shameful: Insteon looks dead—just like its users’ smart homes</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>In 2022, smart home company Insteon abruptly ceased business operations one weekend. Its customers’ home automations for lights, appliances, door locks, and such just stopped working without warning. Emails to customer support went unanswered. The CEO scrubbed his LinkedIn profile. The company just vanished and millions of dollars in smart home electronics became e-waste.</p>
	</div>
</div>

<div id="insteon-again" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#insteon-again"><img src="/posts/leaf-computing/slide-13.webp" loading="lazy" alt="Screenshot of Review Geek article. Insteon Is Back Thanks to a Small Group of Passionate Users"></a>
		<p class="text-sm"><cite><a href="https://www.reviewgeek.com/120635/insteon-is-back-thanks-to-a-small-group-of-passionate-users/">Insteon Is Back Thanks to a “Small Group of Passionate Users”</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>Thankfully, some of its customers connected with each other on Reddit, started reverse engineering protocols, building open source software, and eventually got together to purchase the dead company’s assets. It was a triumph of the human spirit or at least rich techies with some free time.</p>
	</div>
</div>

<div id="missing-server" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#missing-server"><img src="/posts/leaf-computing/slide-14.webp" loading="lazy" alt="Story Time: The missing server"></a>
	</div>
	<div class="md:w-1/2">
		<p>The point of this story is that so many of the physical devices we now own require not just electricity, but a constant Internet connection. They’re right beside you physically and yet a world apart because they can’t connect to a server on another continent.</p>
	</div>
</div>

<div id="no-cloud-meme" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#no-cloud-meme"><img src="/posts/leaf-computing/slide-15.webp" loading="lazy" alt="Laptop stickers. Text: There is no cloud. It’s just someone else’s computer."></a>
	</div>
	<div class="md:w-1/2">
		<p>Ok, final set of stories.</p>
		<p>There is an Internet meme: “There is no cloud. It’s just someone else’s computer.” The point of this meme is not to disparage the genuine innovation of seemingly boundless computational capacity available instantly with an API request and a credit card. The point of this meme is to remind people that when you put your data into the cloud, you are entrusting other people to take care of it. Unfortunately, the companies and the people who work at those companies do not always do the best job at that.</p>
	</div>
</div>

<div id="verkada" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#verkada"><img src="/posts/leaf-computing/slide-16.webp" loading="lazy" alt="Screenshot of Verkada’s website"></a>
	</div>
	<div class="md:w-1/2">
		<p>In 2021, Security camera company Verkada had thousands of customers: big corporations like Tesla, hospitals in 3 US states, several US airports, and even Sandy Hook Elementary School. Its products not only provided video surveillance, but also facial recognition of individuals in the video. The data was extremely sensitive.</p>
	</div>
</div>

<div id="verkada-hacked" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#verkada-hacked"><img src="/posts/leaf-computing/slide-17.webp" loading="lazy" alt="Screenshot of Vice article. Hacked Surveillance Camera Firm Shows Staggering Scale of Facial Recognition. A hacked customer list shows that facial recognition company Verkada is deployed in tens of thousands of schools, bars, stores, jails, and other businesses around the country."></a>
		<p class="text-sm"><cite><a href="https://www.vice.com/en/article/wx83bz/verkada-hacked-facial-recognition-customers">Hacked Surveillance Camera Firm Shows Staggering Scale of Facial Recognition</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>One day, Verkada’s customers got an email informing them that hackers had gotten access to a so called “super admin” employee account. This account allowed the hackers to see all of the live video feeds and archived video of all Verkada’s customers. This was a huge breach.</p>
		<p>The most interesting admission by Verkada was not that a security breach had occurred, but that there was an employee account with this level of access to its customers data in the first place that could be hacked.</p>
	</div>
</div>

<div id="verkada-abuse" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#verkada-abuse"><img src="/posts/leaf-computing/slide-18.webp" loading="lazy" alt="Screenshot of Business Insider article. Male employees at a $1.6 billion security-camera startup were accused of taking photos of female employees and sharing them in a private Slack channel"></a>
		<p class="text-sm"><cite><a href="https://www.businessinsider.com/verkada-security-cameras-ipvm-investigation-2020-10">Male employees at a $1.6 billion security-camera startup were accused of taking photos of female employees and sharing them in a private Slack channel</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>Just a year earlier, a whistleblower at the company went public with accusations that Verkada employees were abusing the level of access they had to customer data. They alleged some employees were taking screenshots of women in the security feeds and sharing them internally. The company denied this, but hackers confirmed this capability still very much existed a year later.</p>
	</div>
</div>

<div id="tesla-abuse" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#tesla-abuse"><img src="/posts/leaf-computing/slide-19.webp" loading="lazy" alt="Screenshot of Reuters article. Special Report. Tesla workers shared sensitive images recorded by customer cars"></a>
		<p class="text-sm"><cite><a href="https://www.reuters.com/technology/tesla-workers-shared-sensitive-images-recorded-by-customer-cars-2023-04-06/">Tesla workers shared sensitive images recorded by customer cars</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>Earlier this month, Tesla went from being a victim of Verkada to being accused of doing the same thing. Tesla cars are equipped with a bunch of cameras used for its autonomous driving and safety features. 9 former employees now claim that for years, Tesla employees would share images and videos from customers’ cars in internal chat groups for amusement. One former employee said, “We could see them doing laundry and really intimate things. We could see their kids.” “We could see inside people’s garages and their private properties,” said another.</p>
	</div>
</div>

<div id="ring-horrors" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#ring-horrors"><img src="/posts/leaf-computing/slide-20.webp" loading="lazy" alt="Screenshots of articles. Vice: Ransomware Group Claims Hack of Amazon's Ring. The Guardian: Ring hackers are reportedly watching and talking to strangers via in-home cameras. The Intercept: For Owners of Amazon's Ring Security Cameras, Strangers May Have Been Watching Too. Politico: The privacy loophole in your doorbell. Police were investigating his neighbor. A judge gave officers access to all his security-camera footage, including inside his home."></a>
		<p class="text-sm"><cite><a href="https://www.vice.com/en/article/qjvd9q/ransomware-group-claims-hack-of-amazons-ring">Ransomware Group Claims Hack of Amazon's Ring</a></cite>, <cite><a href="https://www.theguardian.com/technology/2019/dec/13/ring-hackers-reportedly-watching-talking-strangers-in-home-cameras">Ring hackers are reportedly watching and talking to strangers via in-home cameras</a></cite>, <cite><a href="https://theintercept.com/2019/01/10/amazon-ring-security-camera/">For Owners of Amazon’s Ring Security Cameras, Strangers May Have Been Watching Too</a></cite>, <cite><a href="https://www.politico.com/news/2023/03/07/privacy-loophole-ring-doorbell-00084979">The privacy loophole in your doorbell</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>Amazon Ring, however, truly wins the prize. It not only has extensive allegations of broad employee abuse of customer data and being hacked multiple times, it also has admitted to giving police customer data without user consent and sometimes without a warrant. In one case, Ring not only provided data requested, but additional video inside a customer’s home that was completely unrelated to the investigation.</p>
	</div>
</div>

<div id="1984" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#1984"><img src="/posts/leaf-computing/slide-21.webp" loading="lazy" alt="Story Time: Who's in charge?"></a>
	</div>
	<div class="md:w-1/2">
		<p>People just wanted a way to easily unlock their door and accidentally helped create a dystopian surveillance state. It goes beyond invading the privacy of individuals to potentially harming all of society.</p>
	</div>
</div>

<div id="present-state" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#present-state"><img src="/posts/leaf-computing/slide-23.webp" loading="lazy" alt="The present state of things: Not working well, Not working at all, Working against us"></a>
	</div>
	<div class="md:w-1/2">
		<p>This is the present state of things. I’ve shared stories about Internet connected products not working well when the connection is bad, not working at all when servers are down, and actively working against their users when trust is misplaced. The central theme to these stories is the cloud architecture. </p>
	</div>
</div>

<div id="smart-watch-redesign" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#smart-watch-redesign"><img src="/posts/leaf-computing/slide-24.webp" loading="lazy" alt="Imagine a cloudless smart watch. 1. Works offline 2. Trustless security 3. No strings attached"></a>
	</div>
	<div class="md:w-1/2">
		<p>Does it have to be like this? Are we stuck with the Internet of Shit?</p>
		<p>Let’s look at the smart watch example and try to figure out how we could achieve the same user experience in a way that:</p>
		<ol>
			<li>Works offline</li>
			<li>Doesn’t rely on trusting someone else to protect your data</li>
			<li>Doesn’t become e-waste if the servers go away</li>
		</ol>
	</div>
</div>

<div id="smart-watch-sequence-cloud" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#smart-watch-sequence-cloud"><img src="/posts/leaf-computing/slide-25.webp" loading="lazy" alt="Sequence diagram describing actors of a smartwatch, smartphone, and server with actions described below."></a>
	</div>
	<div class="md:w-1/2">
		<p>The typical present-day architecture looks like this:</p>
		<ol>
			<li>The watch communicates with an app on the phone via Bluetooth to relay data from the watch to the server because the watch itself does not have a constant connection to the Internet. Wi-Fi is not always present and cell radios require paying for data and consume a lot of power from a tiny battery.</li>
			<li>The server does its processing of the watch data</li>
			<li>Sends it back to the phone, which</li>
			<li>Loads the state back to the watch.</li>
		</ol>
	</div>
</div>

<div id="smart-watch-sequence-app" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#smart-watch-sequence-app"><img src="/posts/leaf-computing/slide-26.webp" loading="lazy" alt="Sequence diagram describing smartphone app making many requests to the server"></a>
	</div>
	<div class="md:w-1/2">
		<p>Then, when you use the app, the app makes a bunch of API requests to the server to retrieve the watch data but reformatted in a way that is easier to use as an app developer.</p>
		<p>For example, the number of steps you take can be represented as a daily summary, a minute-level time series, and as progress against a daily step goal from a specific workout.</p>
	</div>
</div>

<div id="gps" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#gps"><img src="/posts/leaf-computing/slide-27.webp" loading="lazy" alt="Map with GPS coordinate dots scattered along path. Dots are in different sizes. Larger dots mean less accuracy."><img src="/posts/leaf-computing/slide-28.webp" loading="lazy" alt="Smoothed line averaging the GPS points to a path"></a>
	</div>
	<div class="md:w-1/2">
		<p>Another example is processing raw GPS data. If you’ve ever looked at raw GPS data, it looks like a scatter-plot of points with varying levels of calculated accuracy. It’s often not usable without some smoothing, which then requires recalculating distances to more closely match reality.</p>
	</div>
</div>

<div id="could-we" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#could-we"><img src="/posts/leaf-computing/slide-29.webp" loading="lazy" alt="Imagine a cloudless smart watch. 1. Works offline 2. Trustless security 3. No strings attached"></a>
	</div>
	<div class="md:w-1/2">
		<p>So how could we make this work offline? Could we just get rid of the server? What would it take to do that? It would mean moving the logic that exists on the server into the smart phone app. That seems quite reasonable to do in this use case.</p>
	</div>
</div>

<div id="powerful-phone" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#powerful-phone"><img src="/posts/leaf-computing/slide-30.webp" loading="lazy" alt="Screenshots of 2 articles. Samsung Research: Your phone is now more powerful than your PC. PC Magazine: 4 Android Smartphones With as Much Power as NASA's Mars Helicopter. The Ingenuity helicopter, which landed on Mars this week via the Perseverance rover, runs a Qualcomm Snapdragon 801 processor, while the rover itself has similar power to early iMacs."></a>
		<p class="text-sm"><cite><a href="https://insights.samsung.com/2021/08/19/your-phone-is-now-more-powerful-than-your-pc-3/">Your phone is now more powerful than your PC</a></cite>, <cite><a href="https://uk.pcmag.com/components/131843/4-android-smartphones-with-as-much-power-as-nasas-mars-helicopter">4 Android Smartphones With as Much Power as NASA's Mars Helicopter</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>Many people’s smart phones are now more powerful than the laptop computers they use, often with more RAM and storage space. There is no significant performance benefit of using a powerful server to do these types of computations.</p>
	</div>
</div>

<div id="smart-watch-sequence-diagram-2" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#smart-watch-sequence-diagram-2"><img src="/posts/leaf-computing/slide-31.webp" loading="lazy" alt="Former sequence diagram with the cloud segments scribbled out."></a>
	</div>
	<div class="md:w-1/2">
		<p>Getting rid of the server not only shifts the computation expense to the phone, but also eliminates the data storage cost and responsibility of the provider. It saves businesses money and is more secure for the customer. Double win. The data stays on the phone and people can use the encrypted backup features of their phone to keep their data safe.</p>
		<p>This proposal is not unrealistic. This is, in fact, exactly the architecture Apple chose when it introduced its own smart watch, the Apple Watch.</p>
	</div>
</div>

<div id="apple-watch" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#apple-watch"><img src="/posts/leaf-computing/slide-32.webp" loading="lazy" alt="Cloudless IoT: more secure, more resilient, more ecological"></a>
	</div>
	<div class="md:w-1/2">
		<p>The Apple Watch’s cloudless architecture is inherently:</p>
		<ul>
			<li>More secure because the data stays on devices within your control</li>
			<li>More resilient because it’s not dependent on network connectivity to function</li>
			<li>More ecological because it will keep on ticking if Apple stops making the Watch tomorrow</li>
		</ul>
		<p>The problem is that other smart watch makers have not chosen to imitate the cloudless architecture of the Apple Watch and the problem is not limited to smart watches. Many smart e-bikes and most smart home products work exactly like Fitbit’s cloud architecture.</p>
	</div>
</div>

<div id="cloud-feud" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#cloud-feud"><img src="/posts/leaf-computing/slide-33.webp" loading="lazy" alt="Family Feud game show board. We asked 100 people: Why are you fixated on cloud services? Answers: 1. Everybody else does it. 2. Helpful tooling. 3. Recurring revenue. 4. Growth hacking."></a>
	</div>
	<div class="md:w-1/2">
		<p>Companies and developers seem fixated on cloud services. Why?</p>
		<ol>
			<li>The cloud web service architecture is pretty much the default choice today. It’s established and easy to get consensus to build. </li>
			<li>There is a ton of tooling to support building products in this way. </li>
			<li>It’s great for business because companies can justify a subscription from a recognizable ongoing operation cost and get recurring revenue.</li>
			<li>Marketers love it because they can mine customer data stored in their cloud for insights without asking for permission.</li>
		</ol>
	</div>
</div>

<div id="hello" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#hello"><img src="/posts/leaf-computing/slide-34.webp" loading="lazy" alt="Introducing leaf computing"></a>
	</div>
	<div class="md:w-1/2">
		<p>To change this, I think we need to name the alternative to the cloud architecture and describe the characteristics to help people understand the tradeoffs. We need to describe it by what it is, not just by what it is not.</p>
		<p>Today, I am excited to share with you the leaf computing architecture.</p>
	</div>
</div>

<div id="locally-executed" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#locally-executed"><img src="/posts/leaf-computing/slide-35.webp" loading="lazy" alt="Leaf software is 1. Locally Executed"></a>
	</div>
	<div class="md:w-1/2">
		<p>The leaf architecture defines software that is locally executed, which means the business logic happens on a device within the user’s control and the user’s data is stored without having to trust another party.</p>
	</div>
</div>

<div id="autonomous" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#autonomous"><img src="/posts/leaf-computing/slide-36.webp" loading="lazy" alt="Leaf software is 2. Autonomous"></a>
	</div>
	<div class="md:w-1/2">
		<p>Leaf software is autonomous. It has as little reliance as is possible and practical on external sources for capabilities.</p>
	</div>
</div>

<div id="federated" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#federated"><img src="/posts/leaf-computing/slide-37.webp" loading="lazy" alt="Leaf software is 3. Federated"></a>
	</div>
	<div class="md:w-1/2">
		<p>Leaf software is federated, which means it prioritizes interoperability of capabilities and data portability across multiple providers.</p>
	</div>
</div>

<div id="local-execution" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#local-execution"><img src="/posts/leaf-computing/slide-38.webp" loading="lazy" alt="Local execution: Where does code run? Where does data get stored?"></a>
	</div>
	<div class="md:w-1/2">
		<p>Let’s go deeper into each of these aspects, starting with local execution. Local execution is about 2 things: where the code runs and where the data gets stored.</p>
	</div>
</div>

<div id="offline-first" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#offline-first"><img src="/posts/leaf-computing/slide-39.webp" loading="lazy" alt="Screenshot of A List Apart article: Designing Offline-First Web Apps"></a>
	</div>
	<div class="md:w-1/2">
		<p>This might sound similar to another idea, offline first.</p>
		<p>Alex Feyerke wrote about apps being <a href="https://alistapart.com/article/offline-first/">offline first</a> in 2013. He advocated for moving logic to the client-side to work offline and using client databases that were sync friendly, so they could share and receive updated state with a server when connectivity was restored. This reduces the server to only doing things the server is necessary to do, such as mirroring the data for a backup or for facilitating multi-user or real-time collaboration.</p>
		<p>In the case of client apps, local execution has much to be inspired from offline first techniques.</p>
	</div>
</div>

<div id="always-online" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#always-online"><img src="/posts/leaf-computing/slide-40.webp" loading="lazy" alt="Local execution: Where does code run? Where does data get stored?"></a>
	</div>
	<div class="md:w-1/2">
		<p>But local execution is more about <em>who</em> controls the device where the logic and data storage happen. It’s also possible to think about local execution happening on a server that is intended to be always online and is under the control of the user.</p>
		<p>Before Software as a Service became the norm, software companies released software that IT departments installed on their own local servers, often in the office where people worked.</p>
		<p>Today, the best-in-class software just isn’t made available in this way and, if it were, there is not an easy and reliable way for IT teams to administer it. We have self-host-able, open source alternatives to <a href="https://element.io/">Slack</a>, <a href="https://www.openproject.org/">Jira</a>, <a href="https://www.xwiki.org/">Confluence</a>, etc, but many of them aren’t as capable or as user friendly yet. They also require people who are Kubernetes and Linux admins to keep them running.</p>
	</div>
</div>

<div id="iserver" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#iserver"><img src="/posts/leaf-computing/slide-41.webp" loading="lazy" alt="Servers in a rack. Top server has a screen with the user interface of the iOS apps list."></a>
	</div>
	<div class="md:w-1/2">
		<p>Why can’t we have an office server with apps that are as easy to install and update as they are on smart phones? I predict someone eventually will make the server equivalent of an iPhone and App Store. When that happens, local execution will be possible for both offline-first and online-always apps.</p>
	</div>
</div>

<div id="nextcloud" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#nextcloud"><img src="/posts/leaf-computing/slide-42.webp" loading="lazy" alt="Screenshot of Nextcloud Hub 4 software"></a>
	</div>
	<div class="md:w-1/2">
		<p>By the way, <a href="https://nextcloud.com/">Nextcloud</a> is one company trying to realize this dream. It still has a long way to go, but I’m cheering them on!</p>
	</div>
</div>

<div id="autonomous-more" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#autonomous-more"><img src="/posts/leaf-computing/slide-43.webp" loading="lazy" alt="Autonomous"></a>
	</div>
	<div class="md:w-1/2">
		<p>Next up: Leaf software is autonomous. Local execution and being autonomous go together quite closely.</p>
		<p>Software is autonomous when dependencies on external services are reduced to as much as is necessary. It does not mean complete isolation. I like to think of this as cloud-assisted software. The power of the Web is, in part, our ability to build and share our unique capabilities over a network. We don’t want to lose that.</p>
		<p>Autonomous software is <em>further empowered</em> by external dependencies, <em>not powerless</em> when those dependencies are unavailable.</p>
	</div>
</div>

<div id="federated-more" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#federated-more"><img src="/posts/leaf-computing/slide-44.webp" loading="lazy" alt="Federated"></a>
	</div>
	<div class="md:w-1/2">
		<p>Lastly, leaf computing utilizes federation.</p>
		<p>Federation is a fancy word for playing nicely with others. It’s a spirit of cooperation between products. In software, it means sharing data formats and protocols.</p>
		<p>When available, we opt to store data in commonly used data formats. If no such formats are available, we document and invite collaboration on the data format. We don’t want to hold user data hostage by a proprietary storage format. </p>
		<p>Many products can interoperate simply by reading and writing data in an agreed upon format. Other times, we need to define protocols or APIs so products know how to communicate with each other because maybe it’s not data, but a capability that’s being shared.</p>
	</div>
</div>

<div id="leaf-recap" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#leaf-recap"><img src="/posts/leaf-computing/slide-45.webp" loading="lazy" alt="Leaf software is 1. Locally Executed. 2. Autonomous. 3. Federated"></a>
	</div>
	<div class="md:w-1/2">
		<p>To recap, leaf computing describes software with an architecture that is</p>
		<ol>
			<li>Locally Executed</li>
			<li>Autonomous</li>
			<li>Federated</li>
		</ol>
		<p>It is appropriate for products where the user is authoritative.</p>
		<p>It’s not appropriate for products where the user must ask for permission to do things. For example, the leaf architecture is not appropriate for an online store, where the store must manage its inventory and confirm payment.</p>
	</div>
</div>

<div id="practice" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#practice"><img src="/posts/leaf-computing/slide-46.webp" loading="lazy" alt="Practice time. Image of Mila air purifier. White cube with black vents and screen on top."></a>
	</div>
	<div class="md:w-1/2">
		<p>Let’s try to apply this by redesigning a smart home air purifier from <a href="https://milacares.com/">Mila</a>. This product actually exists today, but it uses a common cloud architecture. I want to redesign it to get rid of the cloud and use the leaf architecture.</p>
		<p>This smart home air purifier automatically senses when the indoor air quality is bad and adjusts its speed accordingly. It also has the ability to set a schedule to be a white noise generator when I’m sleeping.</p>
	</div>
</div>

<div id="wps" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#wps"><img src="/posts/leaf-computing/slide-47.webp" loading="lazy" alt="Arrow pointing to WPS button on a Wi-Fi router"></a>
	</div>
	<div class="md:w-1/2">
		<p>I excitedly buy it. I take it out of the box and plug it in. To connect it to my home network, I push the <a href="https://en.wikipedia.org/wiki/Wi-Fi_Protected_Setup">Wi-Fi Protected Setup</a> or WPS button on my router and it magically joins. WPS eliminates the complicated pairing process or remembering your Wi-Fi password.</p>
	</div>
</div>

<div id="zeroconf" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#zeroconf"><img src="/posts/leaf-computing/slide-48.webp" loading="lazy" alt="Apple Bonjour logo. Air purifier with QR code on screen and text: Go to air-filter.local"></a>
	</div>
	<div class="md:w-1/2">
		<p>A <em>smart</em> air purifier is basically a <em>dumb</em> air purifier with a web server serving a progressive web app and APIs.</p>
		<p>It uses <a href="http://www.zeroconf.org/">zero-configuration networking</a> (also known as zeroconf or <a href="https://developer.apple.com/bonjour/">Apple Bonjour</a>) to make itself easily discoverable on the home network.</p>
		<p>The screen on the air filter tells me to go to <em class="font-mono">air-filter.local</em> on my phone’s browser.</p>
	</div>
</div>

<div id="web-app" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#web-app"><img src="/posts/leaf-computing/slide-49.webp" loading="lazy" alt="2 screenshots of hypothetical Web app. Graph of air quality over time. Bed time schedule setting set to midnight to 8:00."></a>
	</div>
	<div class="md:w-1/2">
		<p>I see a Web app that shows me the history of the air quality. It also has the setting for scheduling the white noise mode for when I’m sleeping.</p>
		<p>The configuration data and the historical air quality data is stored only on the air purifier itself.</p>
	</div>
</div>

<div id="remote-control" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#remote-control"><img src="/posts/leaf-computing/slide-50.webp" loading="lazy" alt="The remote in remote control?"></a>
	</div>
	<div class="md:w-1/2">
		<p>But what if I want to be able to control it when I’m not on my local network. Let’s say I go on vacation and forgot to turn it off. I don’t want it to use electricity while I’m away because it’s expensive these days.</p>
	</div>
</div>

<div id="nat" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#nat"><img src="/posts/leaf-computing/slide-51.webp" loading="lazy" alt="Complicated diagram describing establishing peer-to-peer connections across network address translation on private networks"></a>
		<p class="text-sm"><cite><a href="https://pdos.csail.mit.edu/papers/p2pnat.pdf">Peer-to-Peer Communication Across Network Address Translators</a></cite></p>
	</div>
	<div class="md:w-1/2">
		<p>The challenge is that I can’t connect to a device inside my home from the outside easily because of network address translation and opening ports on my router is complicated.</p>
		<p>The typical way smart home device manufactures deal with this is to move all the control logic and configuration data back into the cloud, but we want to keep the air purifier as autonomous as possible.</p>
	</div>
</div>

<div id="webrtc" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#webrtc"><img src="/posts/leaf-computing/slide-52.webp" loading="lazy" alt="Screenshot of documentation for WebRTC Data Channel"></a>
	</div>
	<div class="md:w-1/2">
		<p>Fortunately, we have a standard called <a href="https://www.w3.org/TR/webrtc/#peer-to-peer-data-example">WebRTC</a> that allows for peer-to-peer data connections. It’s what is used in many video chat apps today.</p>
		<p>I’m not going to get into the details of the sequence diagram for how this works. The important detail is that it allows for 2 parties on separate, private networks to establish a peer-to-peer connection with only a cloud assist to get it started.</p>
	</div>
</div>

<div id="webrtc2" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#webrtc2"><img src="/posts/leaf-computing/slide-53.webp" loading="lazy" alt="Air purifier on left with a new QR code URL. Hand holding a smart phone with the air purifier Web app loaded against a background of a beach at sunset."></a>
	</div>
	<div class="md:w-1/2">
		<p>The air purifier company hosts a website for this cloud assist. My smart air purifier connects to this website and shows me another link on its screen that I can go to on my phone. I bookmark it or save it to my home screen.</p>
		<p>When I go to this website on my phone, the website facilitates a peer-to-peer connection to my smart home air purifier using WebRTC. The air purifier then serves its progressive Web app and data to my phone just like it would if I were at home on my local network. The cloud server does nothing else. The app on my phone and the air purifier are talking directly to each other once initially connected.</p>
	</div>
</div>

<div id="push-notification" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#push-notification"><img src="/posts/leaf-computing/slide-54.webp" loading="lazy" alt="Screenshot of MDN documentation for Push API"></a>
	</div>
	<div class="md:w-1/2">
		<p>But now, what if I want to get a notification when the air filter needs changing? No problem! The smart air purifier is serving a progressive Web app, which can use the Web <a href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API">Push API</a> to send notifications, just like a cloud-hosted and native mobile app would.</p>
	</div>
</div>

<div id="local-machine-learning" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#local-machine-learning"><img src="/posts/leaf-computing/slide-55.webp" loading="lazy" alt="Mold killing ML‽"></a>
	</div>
	<div class="md:w-1/2">
		<p>But now, what if the smart air purifier company wanted to use machine learning to detect when mold is more likely to grow due to high humidity and preemptively filter the air more before the mold can start to grow and become a problem?</p>
	</div>
</div>

<div id="tensorflow-js" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#tensorflow-js"><img src="/posts/leaf-computing/slide-56.webp" loading="lazy" alt="Screenshot of TensorFlow.js website"></a>
	</div>
	<div class="md:w-1/2">
		<p>The company could use something like <a href="https://www.tensorflow.org/js">TensorFlow.js</a> to run machine learning models directly on the smart air purifier itself.</p>
	</div>
</div>

<div id="weather-data" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#weather-data"><img src="/posts/leaf-computing/slide-57.webp" loading="lazy" alt="Screenshot of Superface documentation for weather data Web API"></a>
	</div>
	<div class="md:w-1/2">
		<p>Again, we’ll use a cloud assist to get the current weather forecast data from some API provider and mash it up with the air purifier’s own sensors and run that machine learning model to predict and protect against mold.</p>
		<p><a href="https://superface.ai/">Superface</a> is a neat product that allows you to do a single API integration and flip between providers as desired, enabling federation even when the providers refuse to agree to a common protocol.</p>
	</div>
</div>

<div id="telemetry" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#telemetry"><img src="/posts/leaf-computing/slide-58.webp" loading="lazy" alt="Hashtag Growth Hackers gonna growth hack"></a>
	</div>
	<div class="md:w-1/2">
		<p>Ok, but now the air purifier marketing folks want to know more about how customers use the smart air purifier out in the real world. Is there any way we can get telemetry data without invading people’s privacy? Yes, there is.</p>
	</div>
</div>

<div id="prio" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#prio"><img src="/posts/leaf-computing/slide-59.webp" loading="lazy" alt="Screenshot of Prio website"></a>
	</div>
	<div class="md:w-1/2">
		<p>Some smart researchers at Stanford University came up with <a href="https://crypto.stanford.edu/prio/">Prio</a>, a privacy-preserving system for the collection of aggregate statistics.</p>
	</div>
</div>

<div id="firefox-prio" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#firefox-prio"><img src="/posts/leaf-computing/slide-60.webp" loading="lazy" alt="Screenshot of Mozilla Hacks blog post: Testing Privacy-Preserving Telemetry with Prio"></a>
	</div>
	<div class="md:w-1/2">
		<p>Mozilla has been using in Firefox since 2018. (<a href="https://hacks.mozilla.org/2018/10/testing-privacy-preserving-telemetry-with-prio/" title="Testing Privacy-Preserving Telemetry with Prio">source</a>) It enables learning about how users use the product without being able to identify individual users, so their privacy is protected. </p>
		<p>Of course, the air filter does ask for permission to participate in aggregated statistic collection first. I agree because I know that products get better with data-informed decisions.</p>
	</div>
</div>

<div id="practice-summary" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#practice-summary"><img src="/posts/leaf-computing/slide-61.webp" loading="lazy" alt="Leaf software is 1. Locally executed. 2. Autonomous. 3. Federated"></a>
	</div>
	<div class="md:w-1/2">
		<p>We now have a rearchitected smart home air purifier that:</p>
		<ol>
			<li><p>Uses locally executed software to serve a progressive Web app, store configuration data, and run local machine learning models.</p>
			</li>
			<li><p>Is autonomous, operating without the cloud when on a private home network, minimally without cloud on the public Internet, and only using weather APIs for real time data it otherwise couldn&#39;t have itself</p>
			</li>
			<li><p>Benefits from federation. It can choose amongst a variety of weather data API providers for advanced functionality. It’s not locked into a single vendor.</p>
			</li>
		</ol>
		<p>I know it’s a simplified example. A real world use case would need to account for the device being put directly on the public Internet for some reason, use on routers without Wi-Fi Protected Setup, multiple smart air purifiers on the same network, and defensively securing the device. My hope is that you got an idea of how to start applying the leaf computing architecture.</p>
	</div>
</div>

<div id="closing" class="container mx-auto md:flex pb-4">
	<div class="pb-4 md:pb-0 md:w-1/2 md:pr-4">
		<a href="#closing"><img src="/posts/leaf-computing/slide-62.webp" loading="lazy" alt="Leaf software is 1. More secure. 2. More resilient. 3. More ecological."></a>
	</div>
	<div class="md:w-1/2">
		<p>By creating software that is locally executed, autonomous, and federated, we get products that are more secure, more resilient, and not at risk of becoming e-waste prematurely.</p>
		<p>The leaf computing architecture benefits the user while reducing security risk liability and operational costs for the manufacturer. What’s great for the environment is also great for the wallet because you aren’t paying for as many server resources.</p>
		<p>I hope you join me in creating technology products with these ideas. <strong>The future will be bright and sunny when it’s a lot less cloudy.</strong></p>
	</div>
</div>

<p class="text-lg text-center">More information can be found at <a href="https://www.leafcomputing.net">LeafComputing.net</a>.</p>
